Bidirectional Reflectance Distribution Function/双向反射分布函数  
BRDF是计算机图形学中最核心的概念之一，他描述的是物体表面将光能从任何一个入射放心反射到任何一个视点方向的反射特性，即入射光线经过某个表面反射后如何在各个出射方向上分布。BRDF模型是绝大多数图形算法中描述光反射现象的基本模型
## 数学基础
### 1.1球面坐标Spherical Coordinate
![](./1.1.png)
其中:
- r表示向量的长度
- $\theta$表示向量和Z轴的夹角
- $\phi$表示向量在x-y平面上的投影和x轴的逆时针夹角。
### 1.2立体角Solid Angle
![](./1.2.jpeg)
我们知道弧度是度量二维角度的量，等于角度在单元圆上对应的弧长，单位圆的周长是2π，所以整个圆对应的弧度也就是2π。立体角则是三维角度的度量，用符合Ω表示，单位为立体弧度(也叫球面度，Steradian，简写为sr)，等于立体角在单位球面上对应的区域的面积(实际上也就是在任意半径的球上除以半径的平方ω=s/(r^2))，单位球的表面积是4π，所以整个球面的立体角也是4π  
![](./1.3.jpeg)  
立体角ω有如下微分形式:  
$d\omega=\frac{dA}{r^2}$  
其中dA为面积片元。而面积微元dA在球面坐标系下可以写成:  
$dA=(rd\theta)(rsin\theta d\phi)=r^2sin\theta d\theta d\phi$  
因此:  
$d\omega=\frac{dA}{r^2}=sin\theta d\theta d\phi$

### 1.3投影面积Foreshortened Area
投影面积描述了一个屋里表面的微小区域在某个视线上的可见面积。  
对于面积微元A，则沿着与法线夹角为$\theta$方向的A的可见面积为:  
$Area=Acos\theta$  
![](./1.4.jpeg)
## 2辐射度量学
### 2.1辐射通量/光通量Radiant Flux
辐射通量描述的是在单位时间穿过截面的光能，或每单位时间的辐射能量，通常用$\phi$来表示，单位是W，瓦特。  
$\phi=\frac{dQ}{dt}$  
其中的Q表示辐射能(Radiant energy)，单位是J，焦耳。

### 2.2辐射强度/发光强度Radiant Intensity
对于一个点(比如说点光源)来说，辐射强度表示单位立体角的辐射通量，用符合I表示，单位$Wsr^{-1}$，瓦特每球面度:  
$I=\frac{d\phi}{d\omega}$  
概括一下:辐射强度，表示每单位立体角的辐射通量。

### 2.3辐射率/光亮度 Radiance
辐射率(Radiance,又译作光亮度，用符号L表示)，表示物体表面沿某一方向的明亮程度，它等于每单位投影和单位立体角上的辐射通量，单位是$W\cdot sr^{-1}\cdot m^{-2}$，瓦特每球面度每平方米。在光学中，光源的辐射率，是描述非点光源时光源单位面积强度的物理量，定义为在指定方向上的单位立体角和垂直此方向的单位面积上的辐射通量。光亮度L也可以理解为发光程度I在表面dA上的积分。  
一种直观的辐射率的理解方法是:将辐射率理解为物体表面的微面元所接收的来自某方向光源的单位面积的光通量，因此截面选用垂直于该方向的截面，其面积按阴影面积技术来算。  
辐射率的微分形式:  
$L=\frac{d^2\phi}{dA\cos\theta d\omega}$  
其中:$\phi$是辐射通量，单位瓦特(W)；$\omega$是立体角，单位球面度(sr)。  
另外需要注意的是，辐射率使用物体表面沿目标方向上的投影面积，不是面积。  
概括一下:辐射率表示每单位立体角没单位投影面积的辐射通量，通常用符合L表示，单位是$W\cdot sr^{-1}\cdot m^{-2}$

### 2.4辐照度/辉度 Irradiance
辐照度(Irradiance,又译名辉度，辐射照度，用符号E表示)，指入射表面的辐射通量，即单位时间内到达单位面积的辐射通量，也就是辐射通量对于面积的密度，用符号E表示，单位$w/m^2$，瓦特每平方米。  
辐照度可以写成辐射率(Radiance)在入射光所形成的半球上的积分:  
$\frac{d\phi}{dA}=E=\int_{\Omega}L(\omega)\cos\theta d\omega$  
其中，$\Omega$是入射光所形成的半球。$L(\omega)$是沿$\omega$方向的光亮度。  